(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[346],{8779:function(e,r,s){Promise.resolve().then(s.bind(s,6981)),Promise.resolve().then(s.bind(s,4950)),Promise.resolve().then(s.bind(s,8349)),Promise.resolve().then(s.bind(s,9774))},6981:function(e,r,s){"use strict";s.d(r,{default:function(){return g}});var t=s(7437),a=s(2265),d=s(2449),l=s(3774),i=s(8728),n=s(2489),o=s(8293),c=s(6943),p=s(2510),x=s(5953);function g(){var e,r,s,g,m;let{t:h}=(0,c.Z)(),{user:u}=(0,p.aF)(),[b,k]=(0,a.useState)("orderSummary"),[y,N]=(0,a.useState)(!1),[f,v]=(0,a.useState)([]),[j,w]=(0,a.useState)(!0),[A,C]=(0,a.useState)(null);(0,a.useEffect)(()=>{(async()=>{var e,r,s;if(!(null==u?void 0:null===(r=u.emailAddresses)||void 0===r?void 0:null===(e=r[0])||void 0===e?void 0:e.emailAddress)){w(!1);return}try{w(!0),C(null);let e=u.emailAddresses[0].emailAddress,r=u.fullName||"Unknown",t=(null===(s=u.primaryPhoneNumber)||void 0===s?void 0:s.phoneNumber)||"",a=await x.Ew.getOrdersByContactInfo(r,t,e);a.success&&a.data?v(a.data):v([])}catch(e){C("Failed to fetch orders. Please try again later."),v([])}finally{w(!1)}})()},[u]);let S=[{id:"orderSummary",label:"Order Summary",icon:d.Z},{id:"addresses",label:"Addresses",icon:l.Z},{id:"accountSettings",label:"Account Settings",icon:i.Z}],E=()=>(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h3",{className:"font-semibold text-pink-700 dark:text-pink-400 text-xl tracking-wide",children:"Recent Orders"}),(0,t.jsx)("div",{className:"flex gap-2",children:(0,t.jsx)("button",{onClick:async()=>{w(!0);try{var e,r,s;let t=null==u?void 0:null===(r=u.emailAddresses)||void 0===r?void 0:null===(e=r[0])||void 0===e?void 0:e.emailAddress,a=(null==u?void 0:u.fullName)||"Unknown",d=(null==u?void 0:null===(s=u.primaryPhoneNumber)||void 0===s?void 0:s.phoneNumber)||"",l=await x.Ew.getOrdersByContactInfo(a,d,t);l.success&&l.data?v(l.data):v([])}catch(e){C("Failed to refresh orders. Please try again later."),v([])}finally{w(!1)}},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Refresh Orders"})})]}),j?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-pink-500 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"Loading orders..."})]}):A?(0,t.jsx)("div",{className:"text-center py-8",children:(0,t.jsxs)("div",{className:"p-4 bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-700 rounded-lg",children:[(0,t.jsx)("p",{className:"text-red-700 dark:text-red-300 mb-2",children:"Error loading orders"}),(0,t.jsx)("p",{className:"text-sm text-red-600 dark:text-red-400",children:A}),(0,t.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-3 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Try Again"})]})}):f.length>0?(0,t.jsx)("div",{className:"space-y-4",children:f.map(e=>(0,t.jsxs)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:shadow-md transition-shadow",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h4",{className:"font-semibold text-gray-900 dark:text-gray-100",children:["Order #",e.orderNumber]}),(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:new Date(e.date).toLocaleDateString()})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("p",{className:"font-semibold text-green-600 dark:text-green-400",children:["Birr ",e.total.toFixed(2)]}),(0,t.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat("completed"===e.status?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300":"pending"===e.status?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300":"bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-300"),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})]})]}),(0,t.jsx)("div",{className:"space-y-2",children:e.products.map((e,r)=>(0,t.jsxs)("div",{className:"flex items-center space-x-3 p-2 bg-gray-50 dark:bg-gray-800 rounded",children:[(0,t.jsx)("img",{src:e.image,alt:e.name,className:"w-12 h-12 object-cover rounded"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:e.name}),(0,t.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Qty: ",e.quantity," \xd7 Birr ",e.price.toFixed(2)]})]})]},r))}),(0,t.jsxs)("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:[(0,t.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[(0,t.jsx)("strong",{children:"Payment:"})," ",e.paymentMethod.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())]}),(0,t.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[(0,t.jsx)("strong",{children:"Shipping:"})," ",e.shippingAddress.street,", ",e.shippingAddress.city,", ",e.shippingAddress.region]})]})]},e._id))}):(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(d.Z,{size:48,className:"text-gray-300 dark:text-gray-600 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mb-2",children:"No orders found"}),(0,t.jsx)("p",{className:"text-sm text-gray-400 dark:text-gray-500",children:"Start shopping to see your orders here"}),(0,t.jsx)("div",{className:"mt-4 p-4 bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-700 rounded-lg",children:(0,t.jsxs)("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:[(0,t.jsx)("strong",{children:"Note:"})," Orders are fetched using your account information. If you've placed orders but don't see them here, please contact support."]})})]})]}),_=()=>{let e=new Map,r=e=>e&&e.street&&e.city?{street:e.street.toLowerCase().trim().replace(/\s+/g," ").replace(/\./g,"").replace(/,/g,"").replace(/street|st\.?/gi,"st").replace(/avenue|ave\.?/gi,"ave").replace(/road|rd\.?/gi,"rd").replace(/boulevard|blvd\.?/gi,"blvd").replace(/drive|dr\.?/gi,"dr").replace(/lane|ln\.?/gi,"ln").replace(/place|pl\.?/gi,"pl").replace(/court|ct\.?/gi,"ct").replace(/circle|cir\.?/gi,"cir").replace(/way/gi,"way").replace(/terrace|ter/gi,"ter"),city:e.city.toLowerCase().trim().replace(/\s+/g," ").replace(/\./g,"").replace(/,/g,""),region:(e.region||"").toLowerCase().trim().replace(/\s+/g," ").replace(/\./g,"").replace(/,/g,"")}:null,s=(e,s)=>{if(!e||!s)return!1;let t=r(e),d=r(s);if(!t||!d)return!1;let l=a(t.street,d.street),i=t.city===d.city,n=t.region===d.region;return l>=.9&&i||t.street===d.street&&i&&n},a=(e,r)=>{if(e===r)return 1;if(0===e.length||0===r.length)return 0;let s=e.length>r.length?e:r,t=e.length>r.length?r:e;if(0===s.length)return 1;let a=d(s,t);return(s.length-a)/s.length},d=(e,r)=>{let s=[];for(let e=0;e<=r.length;e++)s[e]=[e];for(let r=0;r<=e.length;r++)s[0][r]=r;for(let t=1;t<=r.length;t++)for(let a=1;a<=e.length;a++)r.charAt(t-1)===e.charAt(a-1)?s[t][a]=s[t-1][a-1]:s[t][a]=Math.min(s[t-1][a-1]+1,s[t][a-1]+1,s[t-1][a]+1);return s[r.length][e.length]};f.forEach(s=>{if(s.shippingAddress&&s.shippingAddress.street&&s.shippingAddress.city){let t=r(s.shippingAddress);if(!t)return;let a="".concat(t.street,"|").concat(t.city,"|").concat(t.region);if(e.has(a)){let r=e.get(a);r.orderCount+=1,r.orderIds.push(s._id),r.originalAddresses.push(s.shippingAddress),!r.fullName&&s.shippingAddress.fullName&&(r.fullName=s.shippingAddress.fullName),!r.phoneNumber&&s.shippingAddress.phoneNumber&&(r.phoneNumber=s.shippingAddress.phoneNumber),!r.postalCode&&s.shippingAddress.postalCode&&(r.postalCode=s.shippingAddress.postalCode)}else e.set(a,{id:s._id,type:"Shipping Address",street:s.shippingAddress.street,city:s.shippingAddress.city,region:s.shippingAddress.region||"",country:s.shippingAddress.country||"Ethiopia",postalCode:s.shippingAddress.postalCode||"",fullName:s.shippingAddress.fullName||"",phoneNumber:s.shippingAddress.phoneNumber||"",isDefault:!1,orderCount:1,orderIds:[s._id],originalAddresses:[s.shippingAddress]})}});let i=[],n=Array.from(e.keys());for(let t=0;t<n.length;t++)for(let d=t+1;d<n.length;d++){let l=n[t],p=n[d],x=e.get(l),g=e.get(p);if(s(x,g)){var o,c;let e=a((null===(o=r(x))||void 0===o?void 0:o.street)||"",(null===(c=r(g))||void 0===c?void 0:c.street)||"");i.push({key:l,similarKey:p,similarity:e})}}i.sort((e,r)=>r.similarity-e.similarity).forEach(r=>{let{key:s,similarKey:t}=r;if(e.has(s)&&e.has(t)){let r=e.get(s),a=e.get(t);r.orderCount+=a.orderCount,r.orderIds.push(...a.orderIds),r.originalAddresses.push(...a.originalAddresses),!r.fullName&&a.fullName&&(r.fullName=a.fullName),!r.phoneNumber&&a.phoneNumber&&(r.phoneNumber=a.phoneNumber),!r.postalCode&&a.postalCode&&(r.postalCode=a.postalCode),e.delete(t)}});let p=Array.from(e.values());return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("h3",{className:"font-semibold text-pink-700 dark:text-pink-400 text-xl tracking-wide",children:"Saved Addresses"}),p.length>0?(0,t.jsxs)("div",{className:"space-y-4",children:[p.map((e,r)=>(0,t.jsx)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:shadow-md transition-shadow",children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)("span",{className:"px-2 py-1 text-xs bg-pink-100 dark:bg-pink-900/30 text-pink-700 dark:text-pink-300 rounded-full",children:e.type}),e.orderCount>1&&(0,t.jsxs)("span",{className:"px-2 py-1 text-xs bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded-full",children:["Used in ",e.orderCount," order",1!==e.orderCount?"s":""]}),e.originalAddresses&&e.originalAddresses.length>1&&(0,t.jsxs)("span",{className:"px-2 py-1 text-xs bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 rounded-full",children:["Merged ",e.originalAddresses.length," similar address",1!==e.originalAddresses.length?"es":""]}),e.isDefault&&(0,t.jsx)("span",{className:"px-2 py-1 text-xs bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 rounded-full",children:"Default"})]}),e.fullName&&(0,t.jsx)("p",{className:"font-medium text-gray-900 dark:text-gray-100 mb-1",children:e.fullName}),(0,t.jsxs)("div",{className:"space-y-1 text-sm text-gray-600 dark:text-gray-400",children:[(0,t.jsx)("p",{children:e.street}),(0,t.jsxs)("p",{children:[e.city,", ",e.region]}),e.postalCode&&(0,t.jsx)("p",{children:e.postalCode}),(0,t.jsx)("p",{children:e.country}),e.phoneNumber&&(0,t.jsxs)("p",{className:"mt-2 text-pink-600 dark:text-pink-400",children:["\uD83D\uDCDE ",e.phoneNumber]})]})]}),(0,t.jsxs)("div",{className:"flex gap-2 ml-4",children:[(0,t.jsx)("button",{className:"px-3 py-1 text-xs bg-pink-100 dark:bg-pink-900/30 text-pink-700 dark:text-pink-300 rounded hover:bg-pink-200 dark:hover:bg-pink-800/30 transition-colors",children:"Edit"}),(0,t.jsx)("button",{className:"px-3 py-1 text-xs bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",children:"Set Default"})]})]})},e.id||r)),(0,t.jsx)("button",{className:"w-full py-3 px-4 border-2 border-dashed border-pink-300 dark:border-pink-700 text-pink-600 dark:text-pink-400 font-medium rounded-lg hover:bg-pink-50 dark:hover:bg-pink-900/30 transition-colors",children:"Add New Address"})]}):(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(l.Z,{size:48,className:"text-gray-300 dark:text-gray-600 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mb-2",children:"No addresses found"}),(0,t.jsx)("p",{className:"text-sm text-gray-400 dark:text-gray-500",children:f.length>0?"Your order addresses will appear here once you place orders":"Start shopping to see your order addresses here"})]}),(0,t.jsx)("button",{className:"w-full py-3 px-4 border-2 border-dashed border-pink-300 dark:border-pink-700 text-pink-600 dark:text-pink-400 font-medium rounded-lg hover:bg-pink-50 dark:hover:bg-pink-900/30 transition-colors",children:"Add New Address"})]})]})},D=()=>(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("h3",{className:"font-semibold text-pink-700 dark:text-pink-400 text-xl tracking-wide",children:"Account Settings"}),(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(i.Z,{size:48,className:"text-gray-300 dark:text-gray-600 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mb-2",children:"Account settings coming soon"}),(0,t.jsx)("p",{className:"text-sm text-gray-400 dark:text-gray-500",children:"We're working on bringing you more features"})]})]});return(0,t.jsx)("div",{className:"container-responsive py-6 sm:py-12 bg-white dark:bg-gray-900 min-h-screen",children:(0,t.jsxs)("div",{className:"max-w-6xl mx-auto bg-white dark:bg-gray-900 rounded-2xl shadow-xl p-4 sm:p-6 md:p-8 border border-pink-300 dark:border-pink-700",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center gap-4 mb-6 sm:mb-8 md:mb-10",children:[(0,t.jsx)("div",{className:"w-16 h-16 sm:w-24 sm:h-24 rounded-full bg-gradient-to-tr from-pink-500 via-pink-600 to-pink-700 flex items-center justify-center text-3xl sm:text-5xl font-extrabold text-white select-none shadow-xl",children:(null==u?void 0:null===(e=u.firstName)||void 0===e?void 0:e.charAt(0))||(null==u?void 0:null===(s=u.emailAddresses[0])||void 0===s?void 0:null===(r=s.emailAddress)||void 0===r?void 0:r.charAt(0))||"U"}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsxs)("h2",{className:"text-2xl sm:text-3xl font-extrabold text-pink-700 dark:text-pink-400 tracking-wide",children:["Welcome, ",(null==u?void 0:u.firstName)||"User","!"]}),(0,t.jsx)("p",{className:"text-pink-600 dark:text-pink-300 text-base sm:text-lg font-light tracking-wide mt-1",children:"Manage your account and orders"}),(null==u?void 0:null===(g=u.emailAddresses[0])||void 0===g?void 0:g.emailAddress)&&(0,t.jsx)("p",{className:"text-pink-500 dark:text-pink-400 text-sm mt-1",children:u.emailAddresses[0].emailAddress})]})]}),(0,t.jsx)("div",{className:"sm:hidden mb-4",children:(0,t.jsxs)("button",{onClick:()=>N(!y),className:"flex items-center justify-between w-full py-3 px-4 bg-white dark:bg-gray-800 rounded-lg shadow border border-pink-200 dark:border-pink-700",children:[(0,t.jsx)("span",{className:"font-medium text-pink-700 dark:text-pink-400",children:(null===(m=S.find(e=>e.id===b))||void 0===m?void 0:m.label)||"Menu"}),y?(0,t.jsx)(n.Z,{size:20,className:"text-pink-600 dark:text-pink-400"}):(0,t.jsx)(o.Z,{size:20,className:"text-pink-600 dark:text-pink-400"})]})}),(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row gap-6",children:[(0,t.jsx)("nav",{className:"hidden sm:flex flex-col gap-2 w-full sm:w-64 flex-shrink-0",children:S.map(e=>{let r=e.icon;return(0,t.jsxs)("button",{onClick:()=>k(e.id),className:"flex items-center gap-3 px-4 py-3 rounded-xl text-base font-medium transition-all duration-300 ".concat(b===e.id?"bg-pink-600 text-white shadow-lg":"text-pink-700 dark:text-pink-400 hover:bg-pink-100 dark:hover:bg-pink-700"),children:[(0,t.jsx)(r,{size:20}),e.label]},e.id)})}),y&&(0,t.jsx)("nav",{className:"sm:hidden flex flex-col gap-2 w-full mb-4",children:S.map(e=>{let r=e.icon;return(0,t.jsxs)("button",{onClick:()=>{k(e.id),N(!1)},className:"flex items-center gap-3 px-4 py-3 rounded-xl text-base font-medium transition-all duration-300 ".concat(b===e.id?"bg-pink-600 text-white shadow-lg":"text-pink-700 dark:text-pink-400 bg-white dark:bg-gray-800 hover:bg-pink-100 dark:hover:bg-pink-700"),children:[(0,t.jsx)(r,{size:20}),e.label]},e.id)})}),(0,t.jsx)("section",{className:"flex-1 bg-pink-50 dark:bg-gray-800 rounded-2xl p-4 sm:p-6 shadow-lg border border-pink-200 dark:border-pink-600",children:(()=>{switch(b){case"orderSummary":default:return E();case"addresses":return _();case"accountSettings":return D()}})()})]})]})})}}},function(e){e.O(0,[216,623,671,950,744],function(){return e(e.s=8779)}),_N_E=e.O()}]);